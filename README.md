# 智能点名系统 (Teacher's Roll Call Helper)

一个纯前端、无后端的静态网页应用，专为老师上课点名设计。它支持从 Excel 导入名单，提供多种灵活的随机点名方式，并能记录和导出出勤情况。所有数据均存储在浏览器本地，支持离线使用。

## ✨ 功能概览

- **名单导入**: 支持从 `.xlsx` 和 `.csv` 文件导入学生名单。
- **灵活点名**:
  - **随机抽取**: 可设置单次抽取的人数。
  - **抽取模式**: 支持“抽后移除”和“可重复抽”两种模式。
  - **加权随机**: 可为每位学生设置权重，权重越高的学生被抽中的概率越大。
  - **分组点名**: 可在指定的班级或小组内进行点名。
- **出勤记录**:
  - 可将点名结果标记为 **出勤、迟到、缺勤、请假**。
  - 支持手动修改学生状态和添加备注。
- **数据导出**: 可将带有出勤记录的完整名单导出为 `.xlsx` 文件。
- **个性化主题**: 内置 **浅色、深色、黑板** 3套主题，一键切换。
- **数据持久化**: 所有学生数据、设置和历史记录自动保存在浏览器本地 (`localStorage`)，刷新页面不丢失。
- **响应式设计**: 界面美观，完美适配大屏投影和普通笔记本电脑。
- **键盘快捷键**: 支持常用操作快捷键，提升效率。
- **离线使用**: 访问一次后，即可在无网络环境下使用核心功能。

## 🚀 如何使用

1.  **下载项目**: 将本项目所有文件下载到本地文件夹。
2.  **运行**: 直接用现代浏览器（如 Chrome, Firefox, Edge）打开 `index.html` 文件即可。推荐使用一个简单的本地服务器（如 VS Code 的 Live Server 插件）以获得最佳体验，特别是为了确保 Service Worker 正常工作。
3.  **导入名单**:
    - 点击顶部的 “导入名单” 按钮。
    - 选择您的学生名单 Excel 文件。
    - 如果已有数据，会提示您选择“合并导入”或“覆盖导入”。
4.  **设置点名规则**:
    - 在左侧栏设置“抽取人数”、“抽取模式”、“是否启用加权”以及“指定分组”。
5.  **开始点名**:
    - 点击大大的 “开始点名” 按钮，或直接按 `空格键`。
    - 抽中结果会以大字卡片形式显示在主区域。
6.  **记录出勤**:
    - 在下方的学生列表中，点击学生对应的“状态”文字即可循环切换（出勤/迟到/缺勤/请假）。
    - 你也可以在列表中直接修改学生的权重或添加备注。
7.  **导出结果**:
    - 完成点名后，点击顶部的 “导出记录” 按钮，即可下载包含所有学生当前状态的 Excel 文件。

## 📋 Excel 模板说明

为了成功导入，请确保您的 Excel 文件第一行为表头。支持以下字段（表头名称可以为中文或英文）：

- **`Name` / `姓名` (必填)**: 学生的姓名。
- **`Group` / `班级` / `分组` (可选)**: 学生所属的班级或小组，用于分组点名。
- **`Weight` / `权重` (可选)**: 学生的抽中权重。如果未提供，默认为 `1`。
- **`ID` / `学号` (可选)**: 学生的唯一标识符。如果未提供，系统会自动生成一个。建议提供以确保合并数据时能精确匹配。

### 示例 `sample.xlsx`:

| Name (姓名) | Group (班级) | Weight (权重) | ID (学号)   |
| :---------- | :------------- | :------------ | :------------ |
| 张三        | 一班           | 1             | 20230101      |
| 李四        | 一班           | 1.5           | 20230102      |
| 王五        | 二班           | 1             | 20230201      |
| 赵六        | 二班           | 0.5           | 20230202      |
| Alice       | 一班           | 2             | 20230103      |
| Bob         | 二班           | 1             | 20230203      |

## 🎨 主题系统

- **切换主题**: 点击顶部“切换主题”按钮或按 `T` 键，可在 浅色(Light)、深色(Dark)、黑板(Chalkboard) 主题间循环切换。
- **新增主题**:
    1. 打开 `styles/themes.css` 文件。
    2. 复制一个已有的主题规则块 (例如 `[data-theme="dark"] { ... }`)。
    3. 修改选择器，如 `[data-theme="my-new-theme"]`。
    4. 在其中调整 `--bg-color`, `--text-color`, `--accent-color` 等 CSS 变量的值。
    5. 打开 `js/app.js`，在 `toggleTheme` 函数的 `themes` 数组中加入你的新主题名 `'my-new-theme'`。

## ❓ 常见问题

- **导入失败怎么办?**
  - 请检查 Excel 文件格式是否正确，特别是第一行是否为表头。
  - 确保至少包含 “姓名(Name)” 这一列。
  - 尝试将文件另存为 `.xlsx` 格式后再导入。

- **数据丢失了?**
  - 本应用数据存储在浏览器的 `localStorage` 中。清除浏览器缓存（特别是“站点数据”或“Cookie及其他站点数据”）会导致所有数据被删除。请谨慎操作。

- **浏览器兼容性?**
  - 推荐使用最新版本的 Chrome, Firefox, Edge, Safari 浏览器。不支持 IE。

## ⌨️ 快捷键

- **`空格键`**: 开始/再次抽取。
- **`Ctrl + O`**: 打开文件导入对话框。
- **`Ctrl + S`**: 导出点名记录。
- **`T`**: 切换主题。
- **`F11`**: （浏览器的全屏功能）配合**投影模式**按钮，可获得最佳展示效果。

---
Enjoy your teaching!
